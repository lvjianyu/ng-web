!function(n){"use strict";var a=["ngAnimate","ui.router","ui.bootstrap","platform","authentication","ngWeb","ngMessage","angular-loading-bar","textAngular"],i=n.module("app",a);i.config(["cfpLoadingBarProvider",function(n){n.includeSpinner=!1}])}(angular);
!function(n){"use strict";var t=n.module("authentication",[]);window.authentication=window.authentication||{tokenKey:"authentication.key.edu.online",authRequire:"",authSuccess:"",loginSuccess:"",loginFailed:""},t.provider("tokenAuth",function(){this.$get=["$injector","$q",function(){function n(){}var t;return window.localStorage&&(t=window.localStorage),{checkTokenAuth:n}}]}),t.factory("tokenAuthHttpInterceptor",["$rootScope","$q","tokenAuth",function(n,t,e){var o={request:function(n){return n},response:function(n){return n},requestError:function(n){return n},responseError:function(n){return n}};return o}]),t.config(function(){})}(angular);
!function(l){"use strict";l.module("ngWeb",[]).value("topicItemSource",[{topic:"Javascript",liStyle:"bg_lg span3",uiSref:"javascript",iStyle:"icon-leaf",spanStyle:"label label-success"},{topic:"Angularjs",liStyle:"bg_lb span2",uiSref:"angularjs",iStyle:"icon-twitter",spanStyle:"label label-success"},{topic:"NodeJS",liStyle:"bg_ly span2",uiSref:"nodejs",iStyle:"icon-beaker",spanStyle:"label label-success"},{topic:"C#",liStyle:"bg_lo span3",uiSref:"csharp",iStyle:"icon-lemon",spanStyle:"label label-success"},{topic:"MongoDB",liStyle:"bg_ls",uiSref:"mongodb",iStyle:"icon-cloud",spanStyle:"label label-success"},{topic:"SQL",liStyle:"bg_lo",uiSref:"sql",iStyle:"icon-th-large",spanStyle:"label label-success"}])}(angular);
!function(t){"use strict";t.module("platform",[]).config(["$stateProvider","$urlRouterProvider","$locationProvider",function(t,e){e.otherwise("topic"),t.state("topic",{url:"/topic",templateUrl:"/templates/topic"}).state("article",{url:"/article/:id",templateUrl:"/templates/article"}).state("about",{url:"/about",templateUrl:"/templates/about"}).state("category",{url:"/topic/:category",templateUrl:"/templates/topic/topic-category"}).state("edit-article",{url:"/edit-article",templateUrl:"/templates/edit-article"}).state("update-article",{url:"/edit-article/:id",templateUrl:"/templates/edit-article"})}])}(angular);
!function(t){"use strict";t.module("platform").factory("commonService",[function(){function t(t){var e=new Date(t),n=e.getDate(),r="-";10>n&&(n="0"+n);var a=e.getMonth()+1;return 10>a&&(a="0"+a),e.getFullYear()+r+a+r+n}return{YYYYMMDD:t}}])}(angular);
!function(t){"use strict";t.module("platform").factory("dialogService",["$modal","$templateCache",function(e,a){return{show:function(r){var o={};t.copy(r,o),o.template=a.get(r.template);var n=e.open(o);return n.result}}}])}(angular);
!function(t){"use strict";t.module("ngWeb").controller("articleController",["$scope","$http","$state",function(t,n,a){n.get("/api/article/"+a.params.id).then(function(t){200===t.status&&t.data&&$("#articleContent").append(t.data.content)})}])}(angular);
!function(t,e){"use strict";t.module("ngWeb").controller("editArticleController",["$scope","$http","topicItemSource","dialogService","$state",function(t,a,n,r,i){function o(){t.content="",t.title="",t.selectCategory=n[0],t.selectTransfer=t.transfer[0]}function c(t){return e.trim(t)}t.category=n,t.transfer=[{name:"原创",value:!1},{name:"转载",value:!0}],t.submit=function(){var e=c(t.selectCategory.uiSref),n=c(t.selectTransfer.value),i=c(t.title),l=c(t.content);i&&l&&a({method:"post",url:"/api/saveArticle",data:{_id:t._id,category:e,title:i,content:l,transfer:n}}).then(function(t){200===t.status&&t.data&&(o(),r.show({template:"save-ok.html"}))})},t.clear=function(){o()},i.params&&i.params.id?a.get("/api/article/"+i.params.id).then(function(e){200===e.status&&e.data&&(t._id=e.data._id,t.content=e.data.content,t.title=e.data.title,t.selectCategory=_.find(n,{uiSref:e.data.category}),t.selectTransfer=_.find(t.transfer,{value:e.data.transfer}))}):o()}])}(angular,validator);
!function(e){"use strict";e.module("ngWeb").controller("mainframeController",["$scope","$http","$rootScope",function(e,t,s){s.systemUser={username:"welcome",isAuth:!1},t.get("/api/auth/authUser").then(function(e){200!==e.status||e.data.err||(s.systemUser={username:e.data.username,isAdmin:e.data.isAdmin,isAuth:!0})})}])}(angular);
!function(t){"use strict";t.module("ngWeb").controller("topicCategoryController",["$scope","$http","$state",function(t,o,e){o.get("/api/topics/"+e.params.category).then(function(o){200===o.status&&(t.itemSource=o.data)})}])}(angular);
!function(t){"use strict";t.module("ngWeb").controller("topicController",["$scope","$http","topicItemSource",function(t,o,n){t.data=n,o.get("/api/topics/grouptopics").then(function(o){if(200===o.status){{t.data}_.forEach(o.data,function(o){var n=_.find(t.data,function(t){return o._id.toLowerCase()===t.topic.toLowerCase()});n&&(n.number=o.count)})}})}])}(angular);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImF1dGhlbnRpY2F0aW9uLmpzIiwibmctd2ViLmpzIiwicGxhdGZvcm0uanMiLCJjb21tb24tc2VydmljZS5qcyIsImRpYWxvZy1zZXJ2aWNlLmpzIiwiYXJ0aWNsZS1jb250cm9sbGVyLmpzIiwiZWRpdC1hcnRpY2xlLWNvbnRyb2xsZXIuanMiLCJtYWluZnJhbWUtY29udHJvbGxlci5qcyIsInRvcGljLWNhdGVnb3J5LWNvbnRyb2xsZXIuanMiLCJ0b3BpYy1jb250cm9sbGVyLmpzIl0sIm5hbWVzIjpbImFuZ3VsYXIiLCJkZXBlbmRJbmplY3QiLCJhcHAiLCJtb2R1bGUiLCJjb25maWciLCJjZnBMb2FkaW5nQmFyUHJvdmlkZXIiLCJpbmNsdWRlU3Bpbm5lciIsImF1dGhlbnRpY2F0aW9uIiwid2luZG93IiwidG9rZW5LZXkiLCJhdXRoUmVxdWlyZSIsImF1dGhTdWNjZXNzIiwibG9naW5TdWNjZXNzIiwibG9naW5GYWlsZWQiLCJwcm92aWRlciIsInRoaXMiLCIkZ2V0IiwiY2hlY2tUb2tlbkF1dGgiLCJzdG9yYWdlIiwibG9jYWxTdG9yYWdlIiwiZmFjdG9yeSIsIiRyb290U2NvcGUiLCIkcSIsInRva2VuQXV0aCIsImludGVyY2VwdG9yIiwicmVxdWVzdCIsInJlc3BvbnNlIiwicmVxdWVzdEVycm9yIiwicmVqZWN0aW9uIiwicmVzcG9uc2VFcnJvciIsInZhbHVlIiwidG9waWMiLCJsaVN0eWxlIiwidWlTcmVmIiwiaVN0eWxlIiwic3BhblN0eWxlIiwiJHN0YXRlUHJvdmlkZXIiLCIkdXJsUm91dGVyUHJvdmlkZXIiLCJvdGhlcndpc2UiLCJzdGF0ZSIsInVybCIsInRlbXBsYXRlVXJsIiwiWVlZWU1NREQiLCJzdHIiLCJkIiwiRGF0ZSIsImRhdGUiLCJnZXREYXRlIiwic2VwIiwibW9udGgiLCJnZXRNb250aCIsImdldEZ1bGxZZWFyIiwiJG1vZGFsIiwiJHRlbXBsYXRlQ2FjaGUiLCJzaG93Iiwib3B0aW9ucyIsImRlZmF1bHRPcHRpb25zIiwiY29weSIsInRlbXBsYXRlIiwiZ2V0IiwibW9kYWxJbnN0YW5jZSIsIm9wZW4iLCJyZXN1bHQiLCJjb250cm9sbGVyIiwiJHNjb3BlIiwiJGh0dHAiLCIkc3RhdGUiLCJwYXJhbXMiLCJpZCIsInRoZW4iLCJyZXMiLCJzdGF0dXMiLCJkYXRhIiwiJCIsImFwcGVuZCIsImNvbnRlbnQiLCJ2YWxpZGF0b3IiLCJ0b3BpY0l0ZW1Tb3VyY2UiLCJkaWFsb2dTZXJ2aWNlIiwiaW5pdCIsInRpdGxlIiwic2VsZWN0Q2F0ZWdvcnkiLCJzZWxlY3RUcmFuc2ZlciIsInRyYW5zZmVyIiwic2FmZVBvc3QiLCJ0cmltIiwiY2F0ZWdvcnkiLCJuYW1lIiwic3VibWl0IiwibWV0aG9kIiwiX2lkIiwiY2xlYXIiLCJfIiwiZmluZCIsInN5c3RlbVVzZXIiLCJ1c2VybmFtZSIsImlzQXV0aCIsImVyciIsImlzQWRtaW4iLCJpdGVtU291cmNlIiwiZm9yRWFjaCIsImsiLCJ1cGRhdGVJdGVtIiwiaSIsInRvTG93ZXJDYXNlIiwibnVtYmVyIiwiY291bnQiXSwibWFwcGluZ3MiOiJDQUlBLFNBQVdBLEdBQ1AsWUFFQSxJQUFJQyxJQUNBLFlBQ0EsWUFDQSxlQUNBLFdBQ0EsaUJBQ0EsUUFDQSxZQUNBLHNCQUNBLGVBSUFDLEVBQU1GLEVBQVFHLE9BQU8sTUFBT0YsRUFFaENDLEdBQUlFLFFBQVEsd0JBQXlCLFNBQVVDLEdBQzNDQSxFQUFzQkMsZ0JBQWlCLE1Bc0I1Q047Q0N6Q0gsU0FBV0EsR0FDUCxZQUlBLElBQUlPLEdBQWlCUCxFQUFRRyxPQUFPLG9CQUVwQ0ssUUFBT0QsZUFBaUJDLE9BQU9ELGlCQUMzQkUsU0FBVSxnQ0FDVkMsWUFBYSxHQUNiQyxZQUFhLEdBQ2JDLGFBQWMsR0FDZEMsWUFBYSxJQUdqQk4sRUFBZU8sU0FBUyxZQUFhLFdBRWpDQyxLQUFLQyxNQUFRLFlBQWEsS0FBTSxXQVU1QixRQUFTQyxNQVRULEdBQUlDLEVBbUJKLE9BbEJJVixRQUFPVyxlQUNQRCxFQUFVVixPQUFPVyxlQWlC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RXZDRixLQUNBQSxFQUFXRyxPQUFTSixFQUFFSyxnQkFPL0MxRyIsImZpbGUiOiJuZy13ZWIubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIENyZWF0ZWQgYnkgQW5keS5MdiBvbiAyMDE0LzExLzMuXHJcbiAqL1xyXG5cclxuKGZ1bmN0aW9uIChhbmd1bGFyKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgdmFyIGRlcGVuZEluamVjdCA9IFtcclxuICAgICAgICAnbmdBbmltYXRlJyxcclxuICAgICAgICAndWkucm91dGVyJyxcclxuICAgICAgICAndWkuYm9vdHN0cmFwJyxcclxuICAgICAgICAncGxhdGZvcm0nLFxyXG4gICAgICAgICdhdXRoZW50aWNhdGlvbicsXHJcbiAgICAgICAgJ25nV2ViJyxcclxuICAgICAgICAnbmdNZXNzYWdlJyxcclxuICAgICAgICAnYW5ndWxhci1sb2FkaW5nLWJhcicsXHJcbiAgICAgICAgJ3RleHRBbmd1bGFyJ1xyXG4gICAgXTtcclxuICAgIC8vd2luZG93Lmdsb2JlUGF0aD0gJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMCc7XHJcblxyXG4gICAgdmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdhcHAnLCBkZXBlbmRJbmplY3QpO1xyXG5cclxuICAgIGFwcC5jb25maWcoWydjZnBMb2FkaW5nQmFyUHJvdmlkZXInLCBmdW5jdGlvbiAoY2ZwTG9hZGluZ0JhclByb3ZpZGVyKSB7XHJcbiAgICAgICAgY2ZwTG9hZGluZ0JhclByb3ZpZGVyLmluY2x1ZGVTcGlubmVyID0gZmFsc2U7XHJcbiAgICB9XSk7XHJcblxyXG4gICAgLy9hcHAuY29uZmlnKFsnJHByb3ZpZGUnLCBmdW5jdGlvbiAoJHByb3ZpZGUpIHtcclxuICAgIC8vICAgICRwcm92aWRlLmRlY29yYXRvcignJHRlbXBsYXRlQ2FjaGUnLCBbJyRodHRwJywgJyRkZWxlZ2F0ZScsICckaW5qZWN0b3InLCBmdW5jdGlvbiAoJGh0dHAsICRkZWxlZ2F0ZSwgJGluamVjdG9yKSB7XHJcbiAgICAvLyAgICAgICAgJGRlbGVnYXRlLmxvYWRlZFRlbXBsYXRlVXJsID0gZnVuY3Rpb24gKHVybCkge1xyXG4gICAgLy8gICAgICAgICAgICAkaHR0cCh7XHJcbiAgICAvLyAgICAgICAgICAgICAgICB1cmw6IHVybCxcclxuICAgIC8vICAgICAgICAgICAgICAgIG1ldGhvZDogJ0dFVCdcclxuICAgIC8vICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocikge1xyXG4gICAgLy8gICAgICAgICAgICAgICAgJGluamVjdG9yLmdldCgnJGNvbXBpbGUnKShyLmRhdGEpO1xyXG4gICAgLy8gICAgICAgICAgICB9KTtcclxuICAgIC8vICAgICAgICB9O1xyXG4gICAgLy8gICAgICAgIHJldHVybiAkZGVsZWdhdGU7XHJcbiAgICAvLyAgICB9XSk7XHJcbiAgICAvL31dKTtcclxuICAgIC8vXHJcbiAgICAvL2FwcC5ydW4oWyckdGVtcGxhdGVDYWNoZScsICckaHR0cCcsICckY29tcGlsZScsIGZ1bmN0aW9uICgkdGVtcGxhdGVDYWNoZSwgJGh0dHAsICRjb21waWxlKSB7XHJcbiAgICAvLyAgICAkdGVtcGxhdGVDYWNoZS5sb2FkZWRUZW1wbGF0ZVVybCgnL3RlbXBsYXRlL25nLXRlbXBsYXRlLmh0bWwnKTtcclxuICAgIC8vfV0pO1xyXG5cclxuXHJcbn0pKGFuZ3VsYXIpO1xyXG5cclxuLy9hbmd1bGFyLmJvb3RzdHJhcChkb2N1bWVudCwgWydhcHAnXSk7XHJcbiIsIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IEFuZHkuTHYgb24gMjAxNC8xMS8xMS5cclxuICovXHJcblxyXG4oZnVuY3Rpb24gKGFuZ3VsYXIpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICAvL2N1cnJlbnRseSB0aGlzIGF1dGggZnVuY3Rpb24gaXMgbm90IHVzaW5nLlxyXG5cclxuICAgIHZhciBhdXRoZW50aWNhdGlvbiA9IGFuZ3VsYXIubW9kdWxlKCdhdXRoZW50aWNhdGlvbicsIFtdKTtcclxuXHJcbiAgICB3aW5kb3cuYXV0aGVudGljYXRpb24gPSB3aW5kb3cuYXV0aGVudGljYXRpb24gfHwge1xyXG4gICAgICAgIHRva2VuS2V5OiAnYXV0aGVudGljYXRpb24ua2V5LmVkdS5vbmxpbmUnLFxyXG4gICAgICAgIGF1dGhSZXF1aXJlOiAnJyxcclxuICAgICAgICBhdXRoU3VjY2VzczogJycsXHJcbiAgICAgICAgbG9naW5TdWNjZXNzOiAnJyxcclxuICAgICAgICBsb2dpbkZhaWxlZDogJydcclxuICAgIH07XHJcblxyXG4gICAgYXV0aGVudGljYXRpb24ucHJvdmlkZXIoJ3Rva2VuQXV0aCcsIGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgdGhpcy4kZ2V0ID0gWyckaW5qZWN0b3InLCAnJHEnLCBmdW5jdGlvbiAoJGluamVjdG9yLCAkcSkge1xyXG4gICAgICAgICAgICB2YXIgc3RvcmFnZTtcclxuICAgICAgICAgICAgaWYgKHdpbmRvdy5sb2NhbFN0b3JhZ2UpIHtcclxuICAgICAgICAgICAgICAgIHN0b3JhZ2UgPSB3aW5kb3cubG9jYWxTdG9yYWdlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBmdW5jdGlvbiBsb2dpbihuYW1lLCBwYXNzd29yZCkge1xyXG5cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZnVuY3Rpb24gY2hlY2tUb2tlbkF1dGgoKSB7XHJcblxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBmdW5jdGlvbiBnZXRUb2tlbkF1dGgoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdG9rZW5LZXkgPSBzdG9yYWdlLmdldEl0ZW0od2luZG93LmF1dGhlbnRpY2F0aW9uLnRva2VuS2V5KTtcclxuICAgICAgICAgICAgICAgIHZhciBqc29uID0gSlNPTi5wYXJzZSh0b2tlbktleSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ganNvbjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHtjaGVja1Rva2VuQXV0aDogY2hlY2tUb2tlbkF1dGh9O1xyXG4gICAgICAgIH1dO1xyXG4gICAgfSk7XHJcblxyXG4gICAgYXV0aGVudGljYXRpb24uZmFjdG9yeSgndG9rZW5BdXRoSHR0cEludGVyY2VwdG9yJywgWyckcm9vdFNjb3BlJywgJyRxJywgJ3Rva2VuQXV0aCcsIGZ1bmN0aW9uICgkcm9vdFNjb3BlLCAkcSwgdG9rZW5BdXRoKSB7XHJcbiAgICAgICAgZnVuY3Rpb24gY2hlY2tUb2tlbkF1dGgoKSB7XHJcbiAgICAgICAgICAgIGlmICh0b2tlbkF1dGguY2hlY2tUb2tlbkF1dGgoKSkge1xyXG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KHdpbmRvdy5hdXRoZW50aWNhdGlvbi5hdXRoU3VjY2Vzcyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3Qod2luZG93LmF1dGhlbnRpY2F0aW9uLmF1dGhSZXF1aXJlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGludGVyY2VwdG9yID0ge1xyXG4gICAgICAgICAgICAncmVxdWVzdCc6IGZ1bmN0aW9uIChjb25maWcpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBjb25maWc7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICdyZXNwb25zZSc6IGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAncmVxdWVzdEVycm9yJzogZnVuY3Rpb24gKHJlamVjdGlvbikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlamVjdGlvbjtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgJ3Jlc3BvbnNlRXJyb3InOiBmdW5jdGlvbiAocmVqZWN0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVqZWN0aW9uO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXR1cm4gaW50ZXJjZXB0b3I7XHJcbiAgICB9XSk7XHJcblxyXG4gICAgYXV0aGVudGljYXRpb24uY29uZmlnKGZ1bmN0aW9uICgkaHR0cFByb3ZpZGVyKSB7XHJcbiAgICAgICAgLy8kaHR0cFByb3ZpZGVyLmludGVyY2VwdG9ycy5wdXNoKCd0b2tlbkF1dGhIdHRwSW50ZXJjZXB0b3InKTtcclxuICAgIH0pO1xyXG5cclxufSkoYW5ndWxhcik7XHJcblxyXG4iLCIvKipcclxuICogQ3JlYXRlZCBieSBBbmR5Lkx2IG9uIDIwMTQvMTEvMTMuXHJcbiAqL1xyXG4oZnVuY3Rpb24gKGFuZ3VsYXIpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyLm1vZHVsZSgnbmdXZWInLCBbXSkudmFsdWUoJ3RvcGljSXRlbVNvdXJjZScsIFtcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHRvcGljOiAnSmF2YXNjcmlwdCcsXHJcbiAgICAgICAgICAgIGxpU3R5bGU6ICdiZ19sZyBzcGFuMycsXHJcbiAgICAgICAgICAgIHVpU3JlZjogJ2phdmFzY3JpcHQnLFxyXG4gICAgICAgICAgICBpU3R5bGU6ICdpY29uLWxlYWYnLFxyXG4gICAgICAgICAgICBzcGFuU3R5bGU6ICdsYWJlbCBsYWJlbC1zdWNjZXNzJ1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB0b3BpYzogJ0FuZ3VsYXJqcycsXHJcbiAgICAgICAgICAgIGxpU3R5bGU6ICdiZ19sYiBzcGFuMicsXHJcbiAgICAgICAgICAgIHVpU3JlZjogJ2FuZ3VsYXJqcycsXHJcbiAgICAgICAgICAgIGlTdHlsZTogJ2ljb24tdHdpdHRlcicsXHJcbiAgICAgICAgICAgIHNwYW5TdHlsZTogJ2xhYmVsIGxhYmVsLXN1Y2Nlc3MnXHJcbiAgICAgICAgfSxcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHRvcGljOiAnTm9kZUpTJyxcclxuICAgICAgICAgICAgbGlTdHlsZTogJ2JnX2x5IHNwYW4yJyxcclxuICAgICAgICAgICAgdWlTcmVmOiAnbm9kZWpzJyxcclxuICAgICAgICAgICAgaVN0eWxlOiAnaWNvbi1iZWFrZXInLFxyXG4gICAgICAgICAgICBzcGFuU3R5bGU6ICdsYWJlbCBsYWJlbC1zdWNjZXNzJ1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB0b3BpYzogJ0MjJyxcclxuICAgICAgICAgICAgbGlTdHlsZTogJ2JnX2xvIHNwYW4zJyxcclxuICAgICAgICAgICAgdWlTcmVmOiAnY3NoYXJwJyxcclxuICAgICAgICAgICAgaVN0eWxlOiAnaWNvbi1sZW1vbicsXHJcbiAgICAgICAgICAgIHNwYW5TdHlsZTogJ2xhYmVsIGxhYmVsLXN1Y2Nlc3MnXHJcbiAgICAgICAgfSxcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHRvcGljOiAnTW9uZ29EQicsXHJcbiAgICAgICAgICAgIGxpU3R5bGU6ICdiZ19scycsXHJcbiAgICAgICAgICAgIHVpU3JlZjogJ21vbmdvZGInLFxyXG4gICAgICAgICAgICBpU3R5bGU6ICdpY29uLWNsb3VkJyxcclxuICAgICAgICAgICAgc3BhblN0eWxlOiAnbGFiZWwgbGFiZWwtc3VjY2VzcydcclxuICAgICAgICB9LFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdG9waWM6ICdTUUwnLFxyXG4gICAgICAgICAgICBsaVN0eWxlOiAnYmdfbG8nLFxyXG4gICAgICAgICAgICB1aVNyZWY6ICdzcWwnLFxyXG4gICAgICAgICAgICBpU3R5bGU6ICdpY29uLXRoLWxhcmdlJyxcclxuICAgICAgICAgICAgc3BhblN0eWxlOiAnbGFiZWwgbGFiZWwtc3VjY2VzcydcclxuICAgICAgICB9XSk7XHJcblxyXG59KShhbmd1bGFyKTsiLCIvKipcclxuICogQ3JlYXRlZCBieSBBbmR5Lkx2IG9uIDIwMTQvMTEvMTAuXHJcbiAqL1xyXG5cclxuKGZ1bmN0aW9uIChhbmd1bGFyKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhci5tb2R1bGUoJ3BsYXRmb3JtJywgW10pLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgJyR1cmxSb3V0ZXJQcm92aWRlcicsICckbG9jYXRpb25Qcm92aWRlcicsXHJcbiAgICAgICAgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIsICRsb2NhdGlvblByb3ZpZGVyKSB7XHJcbiAgICAgICAgICAgIC8vJGxvY2F0aW9uUHJvdmlkZXIuaHRtbDVNb2RlKHRydWUpO1xyXG4gICAgICAgICAgICAkdXJsUm91dGVyUHJvdmlkZXIub3RoZXJ3aXNlKCd0b3BpYycpO1xyXG5cclxuICAgICAgICAgICAgJHN0YXRlUHJvdmlkZXJcclxuICAgICAgICAgICAgICAgIC5zdGF0ZSgndG9waWMnLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnL3RvcGljJywgdGVtcGxhdGVVcmw6ICcvdGVtcGxhdGVzL3RvcGljJ1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5zdGF0ZSgnYXJ0aWNsZScsIHtcclxuICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYXJ0aWNsZS86aWQnLCB0ZW1wbGF0ZVVybDogJy90ZW1wbGF0ZXMvYXJ0aWNsZSdcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAuc3RhdGUoJ2Fib3V0Jywge1xyXG4gICAgICAgICAgICAgICAgICAgIHVybDogJy9hYm91dCcsIHRlbXBsYXRlVXJsOiAnL3RlbXBsYXRlcy9hYm91dCdcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAuc3RhdGUoJ2NhdGVnb3J5Jywge1xyXG4gICAgICAgICAgICAgICAgICAgIHVybDogJy90b3BpYy86Y2F0ZWdvcnknLCB0ZW1wbGF0ZVVybDogJy90ZW1wbGF0ZXMvdG9waWMvdG9waWMtY2F0ZWdvcnknXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLnN0YXRlKCdlZGl0LWFydGljbGUnLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2VkaXQtYXJ0aWNsZScsIHRlbXBsYXRlVXJsOiAnL3RlbXBsYXRlcy9lZGl0LWFydGljbGUnXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLnN0YXRlKCd1cGRhdGUtYXJ0aWNsZScsIHtcclxuICAgICAgICAgICAgICAgICAgICB1cmw6ICcvZWRpdC1hcnRpY2xlLzppZCcsIHRlbXBsYXRlVXJsOiAnL3RlbXBsYXRlcy9lZGl0LWFydGljbGUnXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICB9XSk7XHJcbn0pKGFuZ3VsYXIpO1xyXG5cclxuIiwiLyoqXHJcbiAqIENyZWF0ZWQgYnkgQW5keS5MdiBvbiAyMDE1LzIvMTUuXHJcbiAqL1xyXG5cclxuKGZ1bmN0aW9uIChhbmd1bGFyKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhci5tb2R1bGUoJ3BsYXRmb3JtJykuZmFjdG9yeSgnY29tbW9uU2VydmljZScsIFtmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIFlZWVlNTUREKHN0cikge1xyXG5cclxuICAgICAgICAgICAgdmFyIGQgPSBuZXcgRGF0ZShzdHIpLFxyXG4gICAgICAgICAgICAgICAgZGF0ZSA9IGQuZ2V0RGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgc2VwID0gJy0nO1xyXG4gICAgICAgICAgICBpZiAoZGF0ZSA8IDEwKSB7XHJcbiAgICAgICAgICAgICAgICBkYXRlID0gJzAnICsgZGF0ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgbW9udGggPSBkLmdldE1vbnRoKCkgKyAxO1xyXG4gICAgICAgICAgICBpZiAobW9udGggPCAxMCkge1xyXG4gICAgICAgICAgICAgICAgbW9udGggPSAnMCcgKyBtb250aDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gZC5nZXRGdWxsWWVhcigpICsgc2VwICsgbW9udGggKyBzZXAgKyBkYXRlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgWVlZWU1NREQ6IFlZWVlNTUREXHJcbiAgICAgICAgfTtcclxuICAgIH1dKTtcclxufSkoYW5ndWxhcik7XHJcbiIsIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IEFuZHkuTHYgb24gMjAxNC8xMS8xMi5cclxuICovXHJcblxyXG4oZnVuY3Rpb24gKGFuZ3VsYXIpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyLm1vZHVsZSgncGxhdGZvcm0nKS5mYWN0b3J5KCdkaWFsb2dTZXJ2aWNlJywgWyckbW9kYWwnLCAnJHRlbXBsYXRlQ2FjaGUnLCBmdW5jdGlvbiAoJG1vZGFsLCAkdGVtcGxhdGVDYWNoZSkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHNob3c6IGZ1bmN0aW9uIChvcHRpb25zKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZGVmYXVsdE9wdGlvbnMgPSB7fTtcclxuICAgICAgICAgICAgICAgIGFuZ3VsYXIuY29weShvcHRpb25zLCBkZWZhdWx0T3B0aW9ucyk7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0T3B0aW9ucy50ZW1wbGF0ZSA9ICR0ZW1wbGF0ZUNhY2hlLmdldChvcHRpb25zLnRlbXBsYXRlKTtcclxuICAgICAgICAgICAgICAgIHZhciBtb2RhbEluc3RhbmNlID0gJG1vZGFsLm9wZW4oZGVmYXVsdE9wdGlvbnMpO1xyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiBtb2RhbEluc3RhbmNlLnJlc3VsdDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9XSk7XHJcbn0pKGFuZ3VsYXIpO1xyXG4iLCIvKipcclxuICogQ3JlYXRlZCBieSBBbmR5Lkx2IG9uIDIwMTUvMi8zLlxyXG4gKi9cclxuXHJcbihmdW5jdGlvbiAoYW5ndWxhcikge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXIubW9kdWxlKCduZ1dlYicpLmNvbnRyb2xsZXIoJ2FydGljbGVDb250cm9sbGVyJywgWyckc2NvcGUnLCAnJGh0dHAnLCAnJHN0YXRlJyxcclxuICAgICAgICBmdW5jdGlvbiAoJHNjb3BlLCAkaHR0cCwgJHN0YXRlKSB7XHJcblxyXG4gICAgICAgICAgICAkaHR0cC5nZXQoJy9hcGkvYXJ0aWNsZS8nICsgJHN0YXRlLnBhcmFtcy5pZCkudGhlbihmdW5jdGlvbiAocmVzKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAocmVzLnN0YXR1cyA9PT0gMjAwICYmIHJlcy5kYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJCgnI2FydGljbGVDb250ZW50JykuYXBwZW5kKHJlcy5kYXRhLmNvbnRlbnQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XSk7XHJcblxyXG59KShhbmd1bGFyKTsiLCIvKipcclxuICogQ3JlYXRlZCBieSBBbmR5Lkx2IG9uIDIwMTUvMi8yLlxyXG4gKi9cclxuXHJcbihmdW5jdGlvbiAoYW5ndWxhciwgdmFsaWRhdG9yKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgLy9KU0hpbnQgVzExN1xyXG4gICAgYW5ndWxhci5tb2R1bGUoJ25nV2ViJykuY29udHJvbGxlcignZWRpdEFydGljbGVDb250cm9sbGVyJywgWyckc2NvcGUnLCAnJGh0dHAnLCAndG9waWNJdGVtU291cmNlJywgJ2RpYWxvZ1NlcnZpY2UnLCAnJHN0YXRlJyxcclxuICAgICAgICBmdW5jdGlvbiAoJHNjb3BlLCAkaHR0cCwgdG9waWNJdGVtU291cmNlLCBkaWFsb2dTZXJ2aWNlLCAkc3RhdGUpIHtcclxuXHJcbiAgICAgICAgICAgICRzY29wZS5jYXRlZ29yeSA9IHRvcGljSXRlbVNvdXJjZTtcclxuICAgICAgICAgICAgJHNjb3BlLnRyYW5zZmVyID0gW3tuYW1lOiAn5Y6f5YibJywgdmFsdWU6IGZhbHNlfSwge25hbWU6ICfovazovb0nLCB2YWx1ZTogdHJ1ZX1dO1xyXG5cclxuICAgICAgICAgICAgZnVuY3Rpb24gaW5pdCgpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5jb250ZW50ID0gJyc7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUudGl0bGUgPSAnJztcclxuICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RDYXRlZ29yeSA9IHRvcGljSXRlbVNvdXJjZVswXTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RUcmFuc2ZlciA9ICRzY29wZS50cmFuc2ZlclswXTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZnVuY3Rpb24gc2FmZVBvc3Qoc3RyKSB7XHJcbiAgICAgICAgICAgICAgICAvL3JldHVybiB2YWxpZGF0b3IuZXNjYXBlKHZhbGlkYXRvci50cmltKHN0cikpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhbGlkYXRvci50cmltKHN0cik7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICRzY29wZS5zdWJtaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgY2F0ZWdvcnkgPSBzYWZlUG9zdCgkc2NvcGUuc2VsZWN0Q2F0ZWdvcnkudWlTcmVmKTtcclxuICAgICAgICAgICAgICAgIHZhciB0cmFuc2ZlciA9IHNhZmVQb3N0KCRzY29wZS5zZWxlY3RUcmFuc2Zlci52YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICB2YXIgdGl0bGUgPSBzYWZlUG9zdCgkc2NvcGUudGl0bGUpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGNvbnRlbnQgPSBzYWZlUG9zdCgkc2NvcGUuY29udGVudCk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKCF0aXRsZSB8fCAhY29udGVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAkaHR0cCh7XHJcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAncG9zdCcsXHJcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2FwaS9zYXZlQXJ0aWNsZScsXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfaWQ6ICRzY29wZS5faWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBjYXRlZ29yeSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IHRpdGxlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBjb250ZW50LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2ZlcjogdHJhbnNmZXJcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocmVzLnN0YXR1cyA9PT0gMjAwICYmIHJlcy5kYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGluaXQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGlhbG9nU2VydmljZS5zaG93KHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlOiAnc2F2ZS1vay5odG1sJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICRzY29wZS5jbGVhciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGluaXQoKTtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIGlmICgkc3RhdGUucGFyYW1zICYmICRzdGF0ZS5wYXJhbXMuaWQpIHtcclxuICAgICAgICAgICAgICAgIC8v5aaC5p6c5Y+C5pWw5a2Y5Zyo77yM5YiZ5Li6dXBkYXRlIVxyXG4gICAgICAgICAgICAgICAgJGh0dHAuZ2V0KCcvYXBpL2FydGljbGUvJyArICRzdGF0ZS5wYXJhbXMuaWQpLnRoZW4oZnVuY3Rpb24gKHJlcykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXMuc3RhdHVzID09PSAyMDAgJiYgcmVzLmRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLl9pZCA9IHJlcy5kYXRhLl9pZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNvbnRlbnQgPSByZXMuZGF0YS5jb250ZW50O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUudGl0bGUgPSByZXMuZGF0YS50aXRsZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdENhdGVnb3J5ID0gXy5maW5kKHRvcGljSXRlbVNvdXJjZSwge3VpU3JlZjogcmVzLmRhdGEuY2F0ZWdvcnl9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdFRyYW5zZmVyID0gXy5maW5kKCRzY29wZS50cmFuc2Zlciwge3ZhbHVlOiByZXMuZGF0YS50cmFuc2Zlcn0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaW5pdCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfV0pO1xyXG59KShhbmd1bGFyLCB2YWxpZGF0b3IpOyIsIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IEFuZHkuTHYgb24gMjAxNC8xMS8xMy5cclxuICovXHJcblxyXG4oZnVuY3Rpb24gKGFuZ3VsYXIpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyLm1vZHVsZSgnbmdXZWInKS5jb250cm9sbGVyKCdtYWluZnJhbWVDb250cm9sbGVyJywgWyckc2NvcGUnLCAnJGh0dHAnLCAnJHJvb3RTY29wZScsXHJcbiAgICAgICAgZnVuY3Rpb24gKCRzY29wZSwgJGh0dHAsICRyb290U2NvcGUpIHtcclxuICAgICAgICAgICAgLy8kc2NvcGUudXNlcm5hbWUgPSAnd2VsY29tZSc7XHJcbiAgICAgICAgICAgIC8vJHNjb3BlLmlzQWRtaW4gPSBmYWxzZTtcclxuICAgICAgICAgICAgLy8kc2NvcGUuaXNBdXRoID0gZmFsc2U7XHJcbiAgICAgICAgICAgICRyb290U2NvcGUuc3lzdGVtVXNlciA9IHtcclxuICAgICAgICAgICAgICAgIHVzZXJuYW1lOiAnd2VsY29tZScsXHJcbiAgICAgICAgICAgICAgICBpc0F1dGg6IGZhbHNlXHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAkaHR0cC5nZXQoJy9hcGkvYXV0aC9hdXRoVXNlcicpLnRoZW4oZnVuY3Rpb24gKHJlcykge1xyXG4gICAgICAgICAgICAgICAgaWYgKHJlcy5zdGF0dXMgPT09IDIwMCAmJiAhcmVzLmRhdGEuZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8kc2NvcGUuaXNBdXRoID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAvLyRzY29wZS5pc0FkbWluID0gcmVzLmRhdGEuaXNBZG1pbjtcclxuICAgICAgICAgICAgICAgICAgICAvLyRzY29wZS51c2VybmFtZSA9IHJlcy5kYXRhLnVzZXJuYW1lO1xyXG4gICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuc3lzdGVtVXNlciA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcm5hbWU6IHJlcy5kYXRhLnVzZXJuYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpc0FkbWluOiByZXMuZGF0YS5pc0FkbWluLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpc0F1dGg6IHRydWVcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XSk7XHJcbn0pKGFuZ3VsYXIpOyIsIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IEFuZHkuTHYgb24gMjAxNS8xLzguXHJcbiAqL1xyXG5cclxuKGZ1bmN0aW9uIChhbmd1bGFyKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhci5tb2R1bGUoJ25nV2ViJykuY29udHJvbGxlcigndG9waWNDYXRlZ29yeUNvbnRyb2xsZXInLCBbJyRzY29wZScsICckaHR0cCcsICckc3RhdGUnLFxyXG4gICAgICAgIGZ1bmN0aW9uICgkc2NvcGUsICRodHRwLCAkc3RhdGUpIHtcclxuICAgICAgICAgICAgJGh0dHAuZ2V0KCcvYXBpL3RvcGljcy8nICsgJHN0YXRlLnBhcmFtcy5jYXRlZ29yeSkudGhlbihmdW5jdGlvbiAocmVzKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAocmVzLnN0YXR1cyA9PT0gMjAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLml0ZW1Tb3VyY2UgPSByZXMuZGF0YTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfV0pO1xyXG5cclxufSkoYW5ndWxhcik7IiwiLyoqXHJcbiAqIENyZWF0ZWQgYnkgQW5keS5MdiBvbiAyMDE0LzExLzEzLlxyXG4gKi9cclxuKGZ1bmN0aW9uIChhbmd1bGFyKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBpbmRleCB3aWxsIHVzZSB0aGlzIGNvbnRyb2xsZXJcclxuICAgICAqL1xyXG4gICAgYW5ndWxhci5tb2R1bGUoJ25nV2ViJykuY29udHJvbGxlcigndG9waWNDb250cm9sbGVyJywgWyckc2NvcGUnLCAnJGh0dHAnLCAndG9waWNJdGVtU291cmNlJyxcclxuICAgICAgICBmdW5jdGlvbiAoJHNjb3BlLCAkaHR0cCwgdG9waWNJdGVtU291cmNlKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5kYXRhID0gdG9waWNJdGVtU291cmNlO1xyXG4gICAgICAgICAgICAkaHR0cC5nZXQoJy9hcGkvdG9waWNzL2dyb3VwdG9waWNzJykudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDIwMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB0ID0gJHNjb3BlLmRhdGE7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaChyZXNwb25zZS5kYXRhLCBmdW5jdGlvbiAoaykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdXBkYXRlSXRlbSA9IF8uZmluZCgkc2NvcGUuZGF0YSwgZnVuY3Rpb24gKGkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBrLl9pZC50b0xvd2VyQ2FzZSgpID09PSBpLnRvcGljLnRvTG93ZXJDYXNlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodXBkYXRlSXRlbSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlSXRlbS5udW1iZXIgPSBrLmNvdW50O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1dKTtcclxuXHJcbn0pKGFuZ3VsYXIpOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==